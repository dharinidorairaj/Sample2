package in.tp.swdd;
	
import static org.assertj.core.api.Assertions.assertThat;
import java.util.Arrays;
import java.util.List;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManager;

import in.tp.swdd.dao.IEmployeeRepo;
import in.tp.swdd.model.Employee;

public class IEmployeeRepoIntegrationTest {

	@Autowired
		private TestEntityManager entityManager;
	
	@Autowired
	private IEmployeeRepo empRepo;
	
	@Test
	private void whenFindAllByEmpName_returnMatchingEmployeeObjects() {
		//initial setup
		
		Employee[] emps = new Employee[] {
				new Employee("Ravi Kumar", "abd.cognizant.com"),
				new Employee("Reema", "reema.cognizant.com")
		};
		
		for(Employee e: emps) {
			entityManager.persist(e);
			
			
		}
		
		//run the method to be tested		
		List<Employee> actual = empRepo.findAllByEmpName("Ravi Kumar");				
		List<Employee> expected = Arrays.asList(emps[0],emps[1]);				
		//verify and declare test reuslt		
		assertThat(actual).isEqualTo(expected);	}

		
	
		
}
